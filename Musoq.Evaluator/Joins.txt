select 
	w.Id, 
	d.Id,
	w.Sum + d.Sum
from #schema.whatever() w 
join #schema.diff() d on w.Id = d.Id 
where 
	d.Abc > 0

=>

with p as (
	select w.Id, w.Sum from #schema.whatever() w
	internal_join => inner (@b.Id = @a.Id)
	select d.Id, d.Sum from #schema.diff() d into @b where d.Abc > 0
)
select * from p